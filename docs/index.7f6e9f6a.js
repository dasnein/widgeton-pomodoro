(o=g||(g={})).Settings="settings",o.State="state",(a=m||(m={})).Start="button-start",a.Stop="button-stop",a.Settings="button-settings",a.Reset="button-reset",(d=h||(h={})).TimeOperation="time-operation",d.TimeRemains="time-remains",d.HeaderRoundCurrent="header-round-current",d.HeaderRoundsTotal="header-rounds-total",(u=_||(_={})).Colored="timer-logo-colored",u.Colorless="timer-logo-colorless",(c=R||(R={})).LongBreak="audio-long-break",c.ShortBreak="audio-short-break",c.Work="audio-work";const t={START:document.getElementById("button-start"),STOP:document.getElementById("button-stop"),SETTINGS:document.getElementById("button-settings"),RESET:document.getElementById("button-reset")},e={TIME_OPERATION:document.getElementById("time-operation"),TIME_REMAINS:document.getElementById("time-remains"),HEADER_ROUND_CURRENT:document.getElementById("header-round-current"),HEADER_ROUNDS_TOTAL:document.getElementById("header-rounds-total")},n={LOGO_COLORED:document.getElementById("timer-logo-colored"),LOGO_COLORLESS:document.getElementById("timer-logo-colorless")};document.getElementById("audio-long-break"),document.getElementById("audio-short-break"),document.getElementById("audio-work");const s={focusPeriod:15e5,shortBreakPeriod:3e5,longBreakPeriod:9e5,rounds:4},i={round:0,running:!1,breakRunning:!1,timeLeft:15e5};(l=T||(T={})).Start="start",l.Stop="stop",l.NextRound="next-round",l.Reset="reset",(E||(E={})).Hidden="hidden";const r=new class{constructor(){this._eventObject={},this._callbackId=0}dispatch(t,...e){let n=this._eventObject[t];if(!n)return console.warn(t+" not found!");for(let t in n)n[t](...e),"d"===t[0]&&delete n[t]}on(t,e){this._eventObject[t]||(this._eventObject[t]={});let n=this._callbackId++;return this._eventObject[t][n]=e,{unSubscribe:()=>{delete this._eventObject[t][n],0===Object.keys(this._eventObject[t]).length&&delete this._eventObject[t]}}}off(t){if(!t){this._eventObject={};return}delete this._eventObject[t]}};var o,a,d,u,c,l,g,m,h,_,R,T,E,O=()=>JSON.parse(localStorage.getItem(g.Settings)||"{}"),S=()=>JSON.parse(localStorage.getItem(g.State)||"{}");const b=new class{constructor(){this._init()}_init(){this._loadSettings(),this._loadState()}_loadSettings(){let t=O();this._settings={...s,...t}}_loadState(){let t=S();this._state={...i,timeLeft:this._settings.focusPeriod,...t}}startTimer(){this._state.running=!0,this.state.round=this.state.round||1,this.reduceTimer()}stopTimer(){this._state.running=!1}reduceTimer(){if(this.state.round>0&&(this._state.timeLeft=this._state.timeLeft-1e3),this._state.timeLeft<0)return r.dispatch(T.NextRound);this._state.running&&setTimeout(this.reduceTimer.bind(this),1e3)}resetTimer(){this._init()}restartTimer(){this._loadState(),this.startTimer()}startBreak(){this._state.breakRunning=!0,this._state.timeLeft=this.state.round===this.settings.rounds?this.settings.longBreakPeriod:this.settings.shortBreakPeriod,this.reduceTimer()}startNextRound(){this._state.breakRunning=!1,this._state.round+=1,this._state.timeLeft=this.settings.focusPeriod,this.reduceTimer()}get settings(){return this._settings}get state(){return this._state}},L={RELAX:"Отдыхаем",WORK:"Работаем"},f=t=>t.toString().padStart(2,"0");function k(){b.state.running?(t.START?.classList.add(E.Hidden),t.STOP?.classList.remove(E.Hidden)):(t.START?.classList.remove(E.Hidden),t.STOP?.classList.add(E.Hidden)),function(){let t=b.state.breakRunning?L.RELAX:L.WORK,n=b.state.timeLeft,s=Math.floor(n/1e3/60),i=`${f(s)}:${f((n-6e4*s)/1e3)}`;e.TIME_OPERATION&&(e.TIME_OPERATION.innerHTML=t),e.TIME_REMAINS&&(e.TIME_REMAINS.innerHTML=i)}(),function(){let t=b.state.round===b.settings.rounds,e=b.state.breakRunning?t?b.settings.longBreakPeriod:b.settings.shortBreakPeriod:b.settings.focusPeriod,s=100-Math.floor(100*b.state.timeLeft/e);n.LOGO_COLORED&&(n.LOGO_COLORED.style.height=`${s}%`)}(),e.HEADER_ROUND_CURRENT&&(e.HEADER_ROUND_CURRENT.innerHTML=b.state.round.toString()),e.HEADER_ROUNDS_TOTAL&&(e.HEADER_ROUNDS_TOTAL.innerHTML=b.settings.rounds.toString()),b.state.running&&window.requestAnimationFrame(k)}t.START?.addEventListener("click",()=>{r.dispatch(T.Start)}),t.STOP?.addEventListener("click",()=>{r.dispatch(T.Stop)}),t.RESET?.addEventListener("click",()=>{r.dispatch(T.Reset)}),r.on(T.Start,function(){b.startTimer(),k()}),r.on(T.Stop,function(){b.stopTimer(),k()}),r.on(T.NextRound,function(){if(b.state.round>=b.settings.rounds&&b.state.breakRunning)return b.restartTimer();b.state.breakRunning?b.startNextRound():b.startBreak()}),r.on(T.Reset,function(){b.resetTimer(),k()}),k();
//# sourceMappingURL=index.7f6e9f6a.js.map
